import numpy as np
from scipy.cluster.hierarchy import linkage, dendrogram
import matplotlib.pyplot as plt

# Datos
datos = np.array([
    [1067855.672, 76589, 13.94267678],
    [212514957.4, 6407102, 33.16865524],
    [8548114.653, 262174, 32.60473828],
    [63764770.77, 2535517, 25.1486268],
    [357258620.8, 7412566, 48.19634938],
    [51404352.37, 2070110, 24.83170091],
    [38858162.12, 1217376, 31.91960588],
    [23953112.45, 998255, 23.9949837],
    [5461366.78, 401849, 13.59059443],
    [23660657.37, 420504, 56.26737766],
    [25758151.71, 1464488, 17.58850309],
    [37523918.98, 1200574, 31.25498218],
    [6001844.915, 534826, 11.2220515],
    [24991953.76, 1784783, 14.00279685],
    [91945942.28, 2919060, 31.49847632],
    [497704.0127, 48114, 10.34426597],
    [1123857.696, 82767, 13.57857232],
    [24011616.06, 1100386, 21.82108466],
    [22262575.88, 880560, 25.28229295],
    [19738417.36, 1341746, 14.710994],
    [58439500.07, 1039722, 56.20685151],
    [21775426.15, 1630592, 13.35430699],
    [23056874.23, 1491689, 15.45689097],
    [5616558.269, 348182, 16.13109888],
    [11941644.16, 539904, 22.11808795],
    [23786362.42, 943401, 25.21341659],
    [2125410.333, 61280, 34.68358898],
    [92276678.16, 2184837, 42.23504003],
    [11516270.76, 904863, 12.7270877],
    [30438180.15, 1330187, 22.8826324],
    [139863153.5, 4475886, 31.2481492],
    [381851.6785, 40797, 9.359797989],
    [956576.6785, 107808, 8.872965629]
])

# Calcula la matriz de enlace utilizando scipy
matriz_enlace = linkage(datos, method='ward')

# Dibuja el dendrograma
plt.figure(figsize=(10, 5))
dendrogram(matriz_enlace, labels=[str(i) for i in range(len(datos))])
plt.title('Dendrograma Jerárquico')
plt.xlabel('Índices de los Datos')
plt.ylabel('Distancia')
plt.show()